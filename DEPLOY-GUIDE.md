# üöÄ Guia Completo de Deploy - Sentinela PIX

## üìã Vis√£o Geral

Este guia mostra como hospedar o **backend** (Node.js + Express) e conect√°-lo ao **frontend** j√° hospedado no Firebase Hosting.

---

## üéØ Op√ß√µes de Hospedagem para o Backend

### 1. **Railway** (Recomendado) ‚≠ê
- ‚úÖ Gratuito: 500h/m√™s (suficiente para projetos pequenos)
- ‚úÖ Deploy autom√°tico via GitHub
- ‚úÖ Suporte para SQLite
- ‚úÖ SSL autom√°tico
- üîó https://railway.app/

### 2. **Render**
- ‚úÖ Gratuito com limita√ß√µes
- ‚úÖ Deploy via GitHub
- ‚ö†Ô∏è SQLite funciona mas recomenda PostgreSQL
- üîó https://render.com/

### 3. **Fly.io**
- ‚úÖ Gratuito com cr√©ditos iniciais
- ‚úÖ Excelente performance
- ‚ö†Ô∏è Configura√ß√£o mais t√©cnica
- üîó https://fly.io/

---

## üöÇ Deploy no Railway (Passo a Passo)

### Passo 1: Preparar o C√≥digo

‚úÖ **J√° feito!** Os arquivos necess√°rios j√° foram criados:
- `backend/Procfile` - Comando de inicializa√ß√£o
- `backend/server.js` - CORS configurado para Firebase
- `frontend/backend-config.js` - Configura√ß√£o de URL din√¢mica

### Passo 2: Fazer Deploy no Railway

1. **Acesse Railway**: https://railway.app/

2. **Login com GitHub**:
   - Clique em "Login"
   - Escolha "Login with GitHub"
   - Autorize o Railway

3. **Criar Novo Projeto**:
   - Clique em "New Project"
   - Selecione "Deploy from GitHub repo"
   - Escolha: `MatheusGino71/A3-sistemas`

4. **Configurar Root Directory**:
   - Ap√≥s selecionar o reposit√≥rio, clique em "Settings"
   - Em "Root Directory", digite: `sentinela-pix/backend`
   - Salve as altera√ß√µes

5. **Adicionar Vari√°veis de Ambiente** (Opcional):
   - V√° em "Variables"
   - Adicione:
     ```
     JWT_SECRET=seu-secret-super-seguro-12345
     NODE_ENV=production
     ```

6. **Deploy Autom√°tico**:
   - Railway detecta automaticamente o `package.json`
   - O deploy come√ßa automaticamente
   - Aguarde 2-5 minutos

7. **Obter a URL**:
   - Clique em "Settings" > "Domains"
   - Clique em "Generate Domain"
   - Copie a URL gerada (ex: `https://sentinela-pix-backend.railway.app`)

### Passo 3: Configurar o Frontend

1. **Execute o script de configura√ß√£o**:
   ```bash
   cd "C:\Users\adm\OneDrive\√Årea de Trabalho\PROJETOS\a3 - quinta\sentinela-pix"
   python configure-backend.py
   ```

2. **Digite a URL do Railway** quando solicitado

3. **Ou edite manualmente**:
   - Abra `frontend/backend-config.js`
   - Altere a linha:
     ```javascript
     PRODUCTION: 'https://sentinela-pix-backend.railway.app', // SUA URL AQUI
     ```

### Passo 4: Atualizar o Dashboard

Adicione o `backend-config.js` no `dashboard.html`:

```html
<!-- ANTES de dashboard.js -->
<script src="backend-config.js"></script>
<script src="dashboard.js"></script>
```

### Passo 5: Fazer Deploy do Frontend

```bash
cd "C:\Users\adm\OneDrive\√Årea de Trabalho\PROJETOS\a3 - quinta\sentinela-pix"
firebase deploy --only hosting
```

### Passo 6: Testar

1. Acesse: https://a3-quinta-1a763.web.app
2. Crie uma conta ou fa√ßa login
3. Verifique se o dashboard carrega os dados
4. Teste criar um relat√≥rio de fraude

---

## üîß Troubleshooting

### Erro: CORS blocked
**Solu√ß√£o**: Verifique se o `server.js` tem:
```javascript
origin: [
    'https://a3-quinta-1a763.web.app',
    'https://a3-quinta-1a763.firebaseapp.com'
]
```

### Erro: Cannot connect to backend
**Solu√ß√£o**: 
1. Abra o Console do navegador (F12)
2. Verifique se a URL est√° correta em `backend-config.js`
3. Teste acessar a URL do backend diretamente no navegador
4. Verifique se o Railway est√° rodando (veja logs no painel)

### Banco de dados vazio ap√≥s deploy
**Solu√ß√£o**: Isso √© normal! O SQLite cria um novo banco vazio. Os dados locais n√£o s√£o transferidos automaticamente. Considere:
- Aceitar que √© um banco novo
- Ou migrar para PostgreSQL (recomendado para produ√ß√£o)

---

## üóÑÔ∏è Migrar para PostgreSQL (Opcional)

Para produ√ß√£o profissional, recomenda-se PostgreSQL:

1. No Railway, adicione um servi√ßo PostgreSQL
2. Copie a `DATABASE_URL`
3. Instale o driver: `npm install pg`
4. Adapte o c√≥digo para usar PostgreSQL em vez de SQLite

---

## üìä Monitoramento

### Railway:
- Acesse o dashboard do projeto
- Veja logs em tempo real
- Monitore uso de recursos
- Configure alertas

### Logs do Backend:
```bash
# No Railway, v√° em "Deployments" e clique no √∫ltimo deploy
# Os logs aparecem em tempo real
```

---

## üí∞ Custos

### Railway Free Tier:
- 500 horas/m√™s gr√°tis
- $5 de cr√©dito por m√™s
- Suficiente para projetos pequenos/m√©dios

### Render Free Tier:
- 750 horas/m√™s gr√°tis
- App hiberna ap√≥s 15min de inatividade
- Reinicia automaticamente no primeiro acesso

---

## ‚úÖ Checklist Final

- [ ] Backend hospedado no Railway/Render
- [ ] URL do backend copiada
- [ ] `backend-config.js` atualizado com a URL
- [ ] `dashboard.html` inclui `backend-config.js`
- [ ] CORS configurado no `server.js`
- [ ] Frontend re-deployado no Firebase
- [ ] Testado: cria√ß√£o de conta
- [ ] Testado: login
- [ ] Testado: dashboard carregando dados
- [ ] Testado: criar relat√≥rio de fraude

---

## üéâ Resultado Final

Ap√≥s completar todos os passos:

- ‚úÖ **Frontend**: https://a3-quinta-1a763.web.app (Firebase Hosting)
- ‚úÖ **Backend**: https://seu-projeto.railway.app (Railway)
- ‚úÖ **Banco de Dados**: SQLite (hospedado no Railway)
- ‚úÖ **Autentica√ß√£o**: Firebase Auth + Firestore
- ‚úÖ **Sistema 100% na nuvem!**

---

## üìû Suporte

Se precisar de ajuda:
1. Verifique os logs no Railway
2. Teste a URL do backend no navegador
3. Verifique o Console do navegador (F12)
4. Revise o arquivo `backend-config.js`
